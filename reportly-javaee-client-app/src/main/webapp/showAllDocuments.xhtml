<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/platformTemplate.xhtml">

	<ui:define name="content">

		<h2 class="text-center">Gestion des documents (for user #{loginBean.loginViewModel.email})</h2>
		<hr />		
		
		<div class="row justify-content-around">
			<div class="col-5">

				<h:dataTable class="table table-hover" value="#{showAllDocumentsManagedBean.getListDocs()}"
					var="doc">
					<h:column>
						<f:facet name="header">
							Id
						</f:facet>
						#{doc.id}
					</h:column>

					<h:column>
						<f:facet name="header">
							Name
						</f:facet>
						#{doc.name}
					</h:column>

					<h:column>
						<f:facet name="header">
							Date de création
						</f:facet>
						#{doc.docCreation}
					</h:column>

					<h:column>
						<f:facet name="header">
							Type de doc
						</f:facet>
						#{doc.typeOfDoc}
					</h:column>

					<h:column>
						<f:facet name="header">
							Supprimer
						</f:facet>

						<h:form class="d-flex justify-content-center">
							<h:commandButton
								action="#{deleteDocumentManagedBean.deleteDoc(doc.id)}"
								value="X" />
						</h:form>
					</h:column>

				</h:dataTable>

			</div>
			
			<p:divider />

			<div class="col-5">

				<h:form id="addDocumentForm" enctype="multipart/form-data">
		        	
		        	<p:growl id="messages" showDetail="true"/>
		        	
					<h:panelGrid columns="1">
						<h:outputLabel id="typeLbl" value="Type du document : " />
						
						<h:selectOneMenu value="#{addDocumentManagedBean.advm.typeOfDoc}">
							<f:selectItem itemLabel="Sélection" itemValue="null" noSelectionOption="true" />
							<f:selectItems var="type" itemLabel="#{type.label}" itemValue="#{type}" 
								value="#{addDocumentManagedBean.typesOfDocuments()}"/>
						</h:selectOneMenu>

						<h:outputLabel id="fileUploadLbl" value="Document à télécharger : " />								
						<p:fileUpload listener="#{addDocumentManagedBean.uploadFile}" 
							mode="advanced" 
							dragDropSupport="false"
			                update="messages" />

					</h:panelGrid>
					<div class="d-flex justify-content-end">
						<h:commandButton value="Enregistrer" class="btn btn-primary me-3" action="#{addDocumentManagedBean.addDocument()}" />
					</div>

				</h:form>
			</div>
		</div>
		
		<hr />

	</ui:define>
</ui:composition>